import{X as T,N as g,ak as y,aD as h,U as F,Y as I,as as D,$ as O,ao as S}from"./B2IfDSsY.js";const K=F({retainFocus:Boolean,captureFocus:Boolean,disableInitialFocus:Boolean},"focusTrap"),w=new Map;let R=0;function L(s){const c=document.activeElement;if(s.key!=="Tab"||!c)return;const o=Array.from(w.values()).filter(u=>{let{isActive:d,contentEl:f}=u;return d.value&&f.value?.contains(c)}).map(u=>u.contentEl.value);let i,r=c.parentElement;for(;r;){if(o.includes(r)){i=r;break}r=r.parentElement}if(!i)return;const e=h(i).filter(u=>u.tabIndex>=0);if(!e.length)return;const n=document.activeElement;if(e.length===1&&e[0].classList.contains("v-list")&&e[0].contains(n)){s.preventDefault();return}const t=e[0],l=e[e.length-1];s.shiftKey&&(n===t||t.classList.contains("v-list")&&t.contains(n))&&(s.preventDefault(),l.focus()),!s.shiftKey&&(n===l||l.classList.contains("v-list")&&l.contains(n))&&(s.preventDefault(),t.focus())}function _(s,c){let{isActive:o,localTop:i,activatorEl:r,contentEl:e}=c;const n=Symbol("trap");let t=!1,l=-1;async function u(){t=!0,l=window.setTimeout(()=>{t=!1},100)}async function d(a){const p=a.relatedTarget,v=a.target;document.removeEventListener("pointerdown",u),document.removeEventListener("keydown",f),await I(),o.value&&!t&&p!==v&&e.value&&D(i)&&![document,e.value].includes(v)&&!e.value.contains(v)&&h(e.value)[0]?.focus()}function f(a){if(a.key==="Tab"&&(document.removeEventListener("keydown",f),o.value&&e.value&&a.target&&!e.value.contains(a.target))){const p=h(document.documentElement);if(a.shiftKey&&a.target===p.at(0)||!a.shiftKey&&a.target===p.at(-1)){const v=h(e.value);v.length>0&&(a.preventDefault(),v[0].focus())}}}const m=O(()=>o.value&&s.captureFocus&&!s.disableInitialFocus);T&&(g(()=>s.retainFocus,a=>{a?w.set(n,{isActive:o,contentEl:e}):w.delete(n)},{immediate:!0}),g(m,a=>{a?(document.addEventListener("pointerdown",u),document.addEventListener("focusin",d,{once:!0}),document.addEventListener("keydown",f)):(document.removeEventListener("pointerdown",u),document.removeEventListener("focusin",d),document.removeEventListener("keydown",f))},{immediate:!0}),R++<1&&document.addEventListener("keydown",L)),y(()=>{w.delete(n),clearTimeout(l),document.removeEventListener("pointerdown",u),document.removeEventListener("focusin",d),document.removeEventListener("keydown",f),--R<1&&document.removeEventListener("keydown",L)})}function $(){const c=S("useScopeId").vnode.scopeId;return{scopeId:c?{[c]:""}:void 0}}const E=Symbol("Forwarded refs");function b(s,c){let o=s;for(;o;){const i=Reflect.getOwnPropertyDescriptor(o,c);if(i)return i;o=Object.getPrototypeOf(o)}}function x(s){for(var c=arguments.length,o=new Array(c>1?c-1:0),i=1;i<c;i++)o[i-1]=arguments[i];return s[E]=o,new Proxy(s,{get(r,e){if(Reflect.has(r,e))return Reflect.get(r,e);if(!(typeof e=="symbol"||e.startsWith("$")||e.startsWith("__"))){for(const n of o)if(n.value&&Reflect.has(n.value,e)){const t=Reflect.get(n.value,e);return typeof t=="function"?t.bind(n.value):t}}},has(r,e){if(Reflect.has(r,e))return!0;if(typeof e=="symbol"||e.startsWith("$")||e.startsWith("__"))return!1;for(const n of o)if(n.value&&Reflect.has(n.value,e))return!0;return!1},set(r,e,n){if(Reflect.has(r,e))return Reflect.set(r,e,n);if(typeof e=="symbol"||e.startsWith("$")||e.startsWith("__"))return!1;for(const t of o)if(t.value&&Reflect.has(t.value,e))return Reflect.set(t.value,e,n);return!1},getOwnPropertyDescriptor(r,e){const n=Reflect.getOwnPropertyDescriptor(r,e);if(n)return n;if(!(typeof e=="symbol"||e.startsWith("$")||e.startsWith("__"))){for(const t of o){if(!t.value)continue;const l=b(t.value,e)??("_"in t.value?b(t.value._?.setupState,e):void 0);if(l)return l}for(const t of o){const l=t.value&&t.value[E];if(!l)continue;const u=l.slice();for(;u.length;){const d=u.shift(),f=b(d.value,e);if(f)return f;const m=d.value&&d.value[E];m&&u.push(...m)}}}}})}export{_ as a,x as f,K as m,$ as u};
